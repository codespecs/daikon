<html>
<head>
   <title>6.170 Lab 2: Debugging Java Programs</title>
</head>
<body bgcolor="#FFFFFF">

<h1>6.170 / Spring 2001 / Lab 2: Debugging Java Programs</h1>   <!-- omit from toc -->
<h2>Handout B1</h2>                           <!-- omit from toc -->

Contents: <!-- auto-generated by html-toc -->
<ul>
  <li><a href="#">Purpose</a>
  <li><a href="#">Exceptions</a>
    <ul>
      <li><a href="#">Common Exceptions</a>
      <li><a href="#">Stack Traces</a>
    </ul>
  <li><a href="#">toString()</a>
  <li><a href="#">An Example: Huffman Encoding</a>
    <ul>
      <li><a href="#">Setup</a>
      <li><a href="#">Debugging the Code</a>
    </ul>
  <li><a href="#">Other Tools</a>
    <ul>
      <li><a href="#">JDB</a>
      <li><a href="#">Jikes</a>
      <li><a href="#">Daikon</a>
    </ul>
</ul>
<p>

<hr>

<h1><a name="">Purpose</a></h1><a name="">

This lab should familiarize you with some of the tools and techniques
available to you to help you debug problems that you may have with
your programs.

<h1><a name="">Exceptions</a></h1>

The exception handling mechanism in Java is a very useful system which
greatly simplifies the reporting of and handling of errors or
&quot;exceptional&quot; circumstances.  Often exceptions are used to
propagate information about some sort of error condition from deep
within a computation to higher up in the program.  When an exception
is thrown but not caught by some part of the program, the Java runtime
system will halt the execution of the program and will print a message
telling you what kind of exception was thrown.

<h2><a name="">Common Exceptions</a></h2>

The Java API contains quite a large number of built in exceptions to
cover many sorts of problems.  Here is a brief list of some of the
ones you are most likely to encounter due to bugs in your program.

<ul>
<li><b><code>NullPointerException</code>:</b>
<code>NullPointerException</code>s occur typically when you attempt to
call a method on a null reference or attempt to access a field of a
null reference.  Some methods also throw them explictily when they are
passed a null argument. </li>

<li><b><code>ArrayIndexOutOfBoundsException</code>:</b> This exception
will occur when you are accessing an element of an array with and
index value which is either larger than the size of the array or less
than zero.</li>

<li><b><code>IndexOutOfBoundsException</code>:</b>An
IndexOutOfBoundsException in the analogue of
<code>ArrayIndexOutOfBoundException</code> except that it occurs when
accessing Vectors or Lists as opposed to arrays.</li>

<li><b><code>ClassCastException</code>:</b> This exception occurs when
you attempt to cast an object to a subclass of which it is not an
instance.  For example if you are using a Vector and you retrieve an
element of the Vector which will be of type Object and attempt to cast
it to an String when it is actually an Integer a ClassCastException
will be thrown at run time. </li>

<li><b><code>IllegalArgumentException</code>:</b> This exception is
commonly thrown by methods when they are passed illegal arguments.
You should consult the documention for the function throwing the
exception to determine the valid domain of arugments.</li>
</ul>

<h2><a name="">Stack Traces</a></h2>

When the Java runtime catches an exception and terminates the program
it not only prints out a message saying what sort of an exception was
caught but also prints out a stack trace showing the method call stack
at the time the exception was thrown.  This bit of information can be
incredibly useful.  For instance when you first run the sample code
for this problem set you will see the following error:

<pre>
athena% java lab2.HuffmanMain
Exception in thread "main" java.lang.NullPointerException
        at lab2.HuffmanMain.getFrequencies(HuffmanMain.java:79)
        at lab2.HuffmanMain.main(HuffmanMain.java:11)
</pre>

The first line of output tells you that an exception has been thrown
and tells you the type of the exception.  In this case it is a
<code>NullPointerException</code>.  The following lines will show you
a snap shot of what methods were calling what other methods at the
time the exception was thrown.  In this case (starting from the
bottom) we see that the program started out executing in
<code>lab2.HuffmanMain.main</code> as we expect it to.  The main
method then, on line 11, called
<code>HuffmanMain.getFrequencies</code> which threw the
NullPointerException on line 79 of the source file.

<p>

If, when debugging, you want to find out about which methods are
calling certain code you can have the Java runtime print out a stack
trace on demand without halting the program by throwing an exception.
To do this call <code>Thread.dumpStack()</code>.

<h1><a name="">toString()</a></h1>

All Java objects have a <code>toString</code> method which returns a
<code>String</code> representation of the object.  Using this can be
an invaluable tool in debugging as it provides a convient way for you
to dump information about the state of your program helping you
understand what is going on.

<p>

As you may have noticed all <code>java.lang.Object</code> provides an
implementation of <code>toString()</code> which will return the name
of the class as well as some implementation specific hash.  In most
cases, therefore, you'll find it in your best interest to override the
<code>toString</code> method with one of your own which returns a
string identifying the class and providing any relevant information.

<p>

In fact because the <code>toString()</code> is available for all
objects, the Java language provides special support to automatically
call it in certain circumstances.  For instance the string
concatenation operationr, <code>+</code>, can automatically call the
toString method on one of it's arguments.  In fact it can also be used
to convert Java primatives to strings.  For instance you could write
the following line in Java:

<pre>
System.out.println("My vector has " + v.size() + " elements which are " + v);
</pre>

When compiling the above line the Java compiler will automatically
insert the appropriate code to convert the result of
<code>size</code>, which is an <code>int</code> to a
<code>String</code> as well as automatically calling
<code>toString()</code> on <code>v</code> to produce a
<code>String</code>.  This will cause the program to output something akin to the following:

<pre>
My vector has 5 elements which are [A, B, C, D, E]
</pre>

<p>
In fact the compiler is even slighty trickier than that in that when
converting an object to a <code>String</code> it will only call
<code>toString()</code> if the reference to the object is non-null,
else it will produce the string <code>&quot;null&quot;</code>.



<h1><a name="">An Example: Huffman Encoding</a></h1>

<a href="http://hissa.nist.gov/dads/HTML/huffmanEncoding.html">Huffman
encoding</a> is a simple form of data encoding which attempts to
represent each input symbol with a sequence of bits such that the most
frequently used symbols are represent with the fewest bits.  Huffman
encoding is described the <a
href="http://mitpress.mit.edu/sicp/full-text/book/book.html">6.001
text</a> (section <a
href="http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-16.html#%_idx_2212">2.3.4</a>)
as well as explained in detail combined with a lovely Java animation
<a href="http://swww.ee.uwa.edu.au/~plsd210/ds/huffman.html">here</a>.

The sample code for this lab consists of a simple Huffman
encoding/decoding scheme.  The file <code><a
href="HuffmanNode.java">HuffmanNode</a></code> is a simple data
structure which can be used to build a tree which is used to decode a
bit stream.  The process of decoding a bit stream involes looking at
each bit in series and choosing the left subtree if the bit is 0 and
the right subtree if the bit is a 1.  When a leaf of the tree is
reached the symbol corresponding to that leaf can be outputted.  The
file <code><a href="HuffmanCodec.java">HuffmanCodec</a></code> is used
to both build the encoding table and decoding tree as well as to
perform the actual encoding and decoding.  A separate instance of
<code>HuffmanCodec</code> is created for a given set of symbols and
frequencies after which it can be used for any input so long as the
input only uses symbols that were used when constructing the codec.
Finally <code><a href="HuffmanMain.java">HuffmanMain</a></code>
contains a short driver to encode/decode two simple strings as well as
some useful methods for converting data types.

<h2><a name="">Setup</a></h2>

First you should copy the source files from /mit/6.170/www/labs/lab2/
to your ~/6.170/lab2 directory as follows:

<pre>
mkdir ~/6.170/lab2
cp /mit/6.170/www/labs/lab2/*.java ~/6.170/lab2
</pre>

Once you have copied the files try to compile them.  They should
compile without any errors.

<h2><a name="">Debugging the Code</a></h2>

If you now run <code>lab2.HuffmanMain</code> you'll find the program
dies by throwing a <code>NullPointerException</code>.  Alas the
Huffman encoder/decoder is broken and now you get to try to fix it.
In some sense this might be a bit more difficult than debugging your
own code since you are not familar with how it works, but on the other
hand you don't already have a notion of what you <em>think</em> is
going in stuck in your head preventing you from seeing what really is
going on.

A very important tip before you start trying to debug the code: read
the code and think about it.  Thinking turns out to be a far more
efficient way of debugging than littering code with
System.out.println's, using a debugger, or anything else.  These other
tools are often useful as you try to get a grasp as to what is going
on, or to verify what you think is happening, but they won't
substitute for some good reasoning about the code.

It may also at some point in the debugging process also become useful
to modify the main method slightly so that you can try out other test
cases.

<h1><a name="">Other Tools</a></h1>

<h2><a name="">JDB</a></h2>

The JDK comes with a debugger called jdb which works in a manner
somewhat similar to gdb.  If you are familar with gdb you may find it
useful to try using jdb.  If not please be patient, hopefully we'll
get to the jdb in a future lab.

<h2><a name="">Jikes</a></h2>
<!-- a blurb could go here -->

<h2><a name="">Daikon</a></h2>
<!-- perhaps somebody wants to drop a sales pitch in here-->

<hr>
Back to the <a href="../index.html">6.170 labs index</a>.
<br>Back to the <a href="../../index.html">6.170 home page</a>.
<br>For problems or questions regarding this page, contact: <a href="mailto:6.170-webmaster@mit.edu">6.170-webmaster@mit.edu</a>.
<hr>
$Id: lab2.html,v 1.6 2001/02/13 18:55:06 jeffshel Exp $
</body>
</html>
